<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Materia prima - Panificación Colombres</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="costos.css">
    <script src="../../config.js"></script>
</head>
<body class="costos-page">
    <a href="../../index.html#costos" class="costos-back"><span class="costos-back-arrow">←</span> Volver al inicio</a>
    <main class="costos-main">
        <div class="costos-title-row">
            <h1 class="costos-title">Materia prima</h1>
            <button type="button" class="costos-calc-btn" id="btn-calculadora-equivalencia" aria-expanded="false">
                <i class="fa-solid fa-calculator" aria-hidden="true"></i>
                <span class="costos-calc-btn-text-long">Calculadora de Equivalencia</span>
                <span class="costos-calc-btn-text-short">Equivalencias</span>
            </button>
        </div>
        <p class="costos-intro">Módulo para cargar los precios de los proveedores (harina, levadura, insumos) y utilizarlos en el cálculo del costo de los productos.</p>

        <div class="costos-calc-panel" id="panel-calculadora-equivalencia" hidden>
            <div class="costos-calc-inner">
                <div class="costos-calc-block costos-calc-datos">
                    <div class="costos-calc-field">
                        <label for="calc-cantidad" class="costos-calc-label">Cantidad</label>
                        <input type="number" id="calc-cantidad" class="costos-calc-input" min="0" step="any" placeholder="Ej: 1" value="1">
                    </div>
                    <div class="costos-calc-field">
                        <label for="calc-unidad" class="costos-calc-label">Unidad de medida</label>
                        <select id="calc-unidad" class="costos-calc-select">
                            <option value="kg">KG</option>
                            <option value="litro">Litro</option>
                            <option value="unidad">Unidad</option>
                            <option value="gramos">Gramos</option>
                            <option value="cc">CC</option>
                        </select>
                    </div>
                    <div class="costos-calc-field">
                        <label for="calc-presentacion" class="costos-calc-label">Presentación</label>
                        <select id="calc-presentacion" class="costos-calc-select">
                            <option value="Bidon">Bidon</option>
                            <option value="Bolsa">Bolsa</option>
                            <option value="Paquete">Paquete</option>
                            <option value="Cajon">Cajon</option>
                            <option value="Caja">Caja</option>
                            <option value="Pote">Pote</option>
                            <option value="Pilon">Pilon</option>
                            <option value="Molde">Molde</option>
                            <option value="Pieza">Pieza</option>
                        </select>
                    </div>
                </div>
                <div class="costos-calc-block costos-calc-destino">
                    <label for="calc-destino" class="costos-calc-label">Convertir a</label>
                    <select id="calc-destino" class="costos-calc-select">
                        <option value="gramos">Gramos</option>
                        <option value="cc">Centímetros cúbico</option>
                        <option value="unidad">Unidad</option>
                    </select>
                </div>
                <div class="costos-calc-block costos-calc-resultado-block">
                    <span class="costos-calc-label">Resultado</span>
                    <output id="calc-resultado" class="costos-calc-resultado" for="calc-cantidad calc-unidad calc-destino">—</output>
                </div>
                <p class="costos-calc-note">Conversiones ilustrativas: 1 KG = 1000 g, 1 L = 1000 cc. La presentación es referencial.</p>
            </div>
        </div>

        <div id="datos-materia-prima" class="costos-datos">
            <p class="costos-loading">Cargando datos…</p>
        </div>
    </main>
    <script src="costos-sheet.js"></script>
    <script>
(function () {
    var btn = document.getElementById("btn-calculadora-equivalencia");
    var panel = document.getElementById("panel-calculadora-equivalencia");
    var cantidad = document.getElementById("calc-cantidad");
    var unidad = document.getElementById("calc-unidad");
    var presentacion = document.getElementById("calc-presentacion");
    var destino = document.getElementById("calc-destino");
    var resultado = document.getElementById("calc-resultado");

    function nombreUnidad(val) {
        return { kg: "KG", litro: "L", unidad: "unidad", gramos: "g", cc: "cc" }[val] || val;
    }
    function calcularEquivalencia() {
        var q = parseFloat(cantidad.value) || 0;
        var u = unidad.value;
        var p = presentacion.value;
        var d = destino.value;
        if (q <= 0 || !resultado) {
            if (resultado) resultado.textContent = "—";
            return;
        }
        var resNum = q;
        var resUnidad = "";
        if (d === "gramos") {
            if (u === "kg") resNum = q * 1000;
            else if (u === "gramos") resNum = q;
            else resNum = q;
            resUnidad = resNum.toLocaleString("es-AR") + " g";
        } else if (d === "cc") {
            if (u === "litro") resNum = q * 1000;
            else if (u === "cc") resNum = q;
            else resNum = q;
            resUnidad = resNum.toLocaleString("es-AR") + " cc";
        } else {
            resNum = q;
            resUnidad = resNum.toLocaleString("es-AR") + " unidad";
        }
        resultado.textContent = q + " " + nombreUnidad(u) + " [" + p + "] equivale a " + resUnidad;
    }

    if (btn && panel) {
        btn.addEventListener("click", function () {
            var open = panel.getAttribute("hidden") === null;
            if (open) {
                panel.setAttribute("hidden", "");
                btn.setAttribute("aria-expanded", "false");
            } else {
                panel.removeAttribute("hidden");
                btn.setAttribute("aria-expanded", "true");
                calcularEquivalencia();
            }
        });
    }
    [cantidad, unidad, presentacion, destino].forEach(function (el) {
        if (el) el.addEventListener("input", calcularEquivalencia);
        if (el) el.addEventListener("change", calcularEquivalencia);
    });
})();
    </script>
</body>
</html>
